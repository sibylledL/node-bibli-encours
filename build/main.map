{"version":3,"sources":["webpack:///webpack/bootstrap fe44e11de5ee60a0a24f","webpack:///external \"express\"","webpack:///./src/models/livres.js","webpack:///external \"mongoose\"","webpack:///external \"body-parser\"","webpack:///external \"passport\"","webpack:///./src/models/users.js","webpack:///external \"multer\"","webpack:///external \"bcrypt\"","webpack:///external \"passport-local\"","webpack:///external \"connect-flash\"","webpack:///./src/index.js","webpack:///external \"volleyball\"","webpack:///external \"dotenv/config\"","webpack:///external \"path\"","webpack:///external \"express-session\"","webpack:///./src/routes/addbook.js","webpack:///external \"passport-local-mongoose\"","webpack:///./src/routes/fiche.js","webpack:///./src/routes/accueil.js","webpack:///./config/passport.js"],"names":["Schema","mongoose","livreSchema","titre","String","auteur","prix","Number","isbn","date","couv","resume","info","cat","Livre","model","passportLocalMongoose","require","userSchema","name","type","index","unique","password","User","app","express","use","static","set","path","join","__dirname","SERVER_PORT","DBUrl","process","env","url","bodyParser","urlencoded","extended","console","log","connection","on","connect","json","session","secret","flash","passport","initialize","get","req","res","render","listen","upload","multer","dest","livresRouter","Router","post","single","newlivre","body","file","filename","save","err","livre","send","redirect","livreid","params","id","findById","sendStatus","findByIdAndUpdate","$set","new","error","find","livres","newUser","bcrypt","genSalt","salt","hash","user","authenticate","successRedirect","failureRedirect","failureFlash","ficheRouter","accueilRouter","serializeUser","done","deserializeUser","usernameField","passwordField","passReqToCallback","findOne","message","result"],"mappings":";;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA,oC;;;;;;;;;;ACAA;AACA,MAAMA,SAAS,gDAAAC,CAASD,MAAxB;;AAEA,MAAME,cAAc,IAAIF,MAAJ,CAAW;AAC7BG,SAAMC,MADuB;AAE7BC,UAAOD,MAFsB;AAG7BE,QAAKC,MAHwB;AAI7BC,QAAKJ,MAJwB;AAK7BK,QAAKF,MALwB;AAM7BG,QAAKN,MANwB;AAO7BO,UAAOP,MAPsB;AAQ7BQ,QAAKR,MARwB;AAS7BS,OAAIT;AATyB,CAAX,CAApB;;AAaA,MAAMU,QAAQ,gDAAAb,CAASc,KAAT,CAAe,OAAf,EAAwBb,WAAxB,CAAd;;;;;;;AChBA,qC;;;;;;ACAA,wC;;;;;;ACAA,qC;;;;;;;;;;ACAA;AACA,MAAMF,SAAS,gDAAAC,CAASD,MAAxB;AACA,IAAIgB,wBAAwB,mBAAAC,CAAQ,EAAR,CAA5B;;AAEA,MAAMC,aAAa,IAAIlB,MAAJ,CAAY;AAC7BmB,QAAK,EAACC,MAAMhB,MAAP,EAAeiB,OAAM,EAAEC,QAAO,IAAT,EAArB,EADwB;AAE7BC,YAASnB;AAFoB,CAAZ,CAAnB;;AAKA,MAAMoB,OAAO,gDAAAvB,CAASc,KAAT,CAAe,MAAf,EAAuBG,UAAvB,CAAb;;;;;;;ACTA,mC;;;;;;ACAA,mC;;;;;;ACAA,2C;;;;;;ACAA,0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA,MAAMO,MAAM,+CAAAC,EAAZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGAD,IAAIE,GAAJ,CAAQ,+CAAAD,CAAQE,MAAR,CAAe,QAAf,CAAR;AACAH,IAAII,GAAJ,CAAQ,OAAR,EAAiB,4CAAAC,CAAKC,IAAL,CAAUC,YAAY,QAAtB,CAAjB;AACAP,IAAII,GAAJ,CAAQ,aAAR,EAAsB,KAAtB;AACA;;AAEA;AACA;AACA;;AAGA,MAAM,EAAEI,WAAF,EAAeC,KAAf,KAAyBC,QAAQC,GAAvC;AACA,MAAMC,MAAMH,KAAZ;;AAEAT,IAAIE,GAAJ,CAAQ,mDAAAW,CAAWC,UAAX,CAAsB,EAAEC,UAAW,IAAb,EAAtB,CAAR;AACA;AACAC,QAAQC,GAAR,CAAY,8DAAZ;;AAGA,gDAAAzC,CAAS0C,UAAT,CAAoBC,EAApB,CAAuB,WAAvB,EAAmC,MAAM;AACvCH,UAAQC,GAAR,CAAa,oCAAb;AACD,CAFD;AAGA,gDAAAzC,CAAS4C,OAAT,CAAiBR,GAAjB;;AAGA,mBAAApB,CAAQ,EAAR;AACAQ,IAAIE,GAAJ,CAAQ,+CAAAD,CAAQoB,IAAR,EAAR;AACArB,IAAIE,GAAJ,CAAQ,+CAAAD,CAAQa,UAAR,CAAmB,EAACC,UAAW,IAAZ,EAAnB,CAAR;AACAf,IAAIE,GAAJ,CAAQ,kDAAR;AACAF,IAAIE,GAAJ,CAAQ,wDAAAoB,CAAQ,EAACC,QAAO,QAAR,EAAR,CAAR;AACAvB,IAAIE,GAAJ,CAAQ,qDAAAsB,EAAR;AACAxB,IAAIE,GAAJ,CAAQ,iDAAAuB,CAASC,UAAT,EAAR;AACA1B,IAAIE,GAAJ,CAAQ,iDAAAuB,CAASH,OAAT,EAAR;;AAIAtB,IAAIE,GAAJ,CAAQ,QAAR,EAAkB,yEAAlB;AACAF,IAAIE,GAAJ,CAAQ,SAAR,EAAmB,sEAAnB;AACAF,IAAIE,GAAJ,CAAQ,UAAR,EAAoB,0EAApB;;AAEAF,IAAI2B,GAAJ,CAAQ,GAAR,EAAa,CAACC,GAAD,EAAMC,GAAN,KAAc;AACzBA,MAAIC,MAAJ,CAAW,MAAX;AACD,CAFD;;AAIA;AACA;AACA;AACA;AACA;AACA;;;AAKA;;;;;;;;;;;;;AAcA9B,IAAI+B,MAAJ,CAAWvB,WAAX,EAAuB,MAAM;AAC3BQ,UAAQC,GAAR,CAAa,qBAAb,EAAmCT,WAAnC;AACD,CAFD,E;;;;;;;AClFA,uC;;;;;;ACAA,0C;;;;;;ACAA,iC;;;;;;ACAA,4C;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMwB,SAAS,8CAAAC,CAAO,EAACC,MAAK,iBAAN,EAAP,CAAf;;AAEA,MAAMC,eAAe,+CAAAlC,CAAQmC,MAAR,EAArB;;AAIAD,aAAaR,GAAb,CAAiB,UAAjB,EAA4B,CAACC,GAAD,EAAKC,GAAL,KAAa;AACvCA,MAAIC,MAAJ,CAAW,OAAX;AACD,CAFD;;AAIAK,aAAaE,IAAb,CAAkB,UAAlB,EAA8BL,OAAOM,MAAP,CAAc,MAAd,CAA9B,EAAoD,CAACV,GAAD,EAAKC,GAAL,KAAa;AAC/D,MAAIU,WAAW,IAAI,6DAAJ,CAAUX,IAAIY,IAAd,CAAf;AACA,MAAGZ,IAAIa,IAAP,EAAY;AACTF,aAAStD,IAAT,GAAgB2C,IAAIa,IAAJ,CAASC,QAAzB;AACF,GAFD,MAEK;AACHH,aAAStD,IAAT,GAAgB,aAAhB;AACD;;AAEDsD,WAASI,IAAT,CAAc,CAACC,GAAD,EAAKC,KAAL,KAAe;AAC3B,QAAGD,GAAH,EAAQf,IAAIiB,IAAJ,CAASF,GAAT;AACRf,QAAIkB,QAAJ,CAAa,QAAb;AAED,GAJD;AAMD,CAdD;AAeA;AACAZ,aAAaR,GAAb,CAAiB,WAAjB,EAA8B,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC1C,MAAImB,UAAUpB,IAAIqB,MAAJ,CAAWC,EAAzB;AACA7D,EAAA,6DAAAA,CAAM8D,QAAN,CAAeH,OAAf,EAAwB,CAACJ,GAAD,EAAMC,KAAN,KAAgB;AACtC,QAAGD,GAAH,EAAQ,MAAMA,GAAN;;AAERf,QAAIC,MAAJ,CAAW,WAAX,EAAwB,EAACe,OAAOA,KAAR,EAAxB;AACD,GAJD;AAKD,CAPD;;AASA;AACAV,aAAaE,IAAb,CAAkB,WAAlB,EAA+B,CAACT,GAAD,EAAMC,GAAN,KAAc;AAC3C,MAAG,CAACD,IAAIY,IAAR,EAAa;AACX,WAAOX,IAAIuB,UAAJ,CAAe,GAAf,CAAP;AACD;AACD,QAAMF,KAAKtB,IAAIqB,MAAJ,CAAWC,EAAtB;AACA7D,EAAA,6DAAAA,CAAMgE,iBAAN,CAAwBH,EAAxB,EAA4B,EAACI,MAAK;AAChC5E,aAAOkD,IAAIY,IAAJ,CAAS9D,KADgB;AAEhCE,cAASgD,IAAIY,IAAJ,CAAS5D,MAFc;AAGhCC,YAAO+C,IAAIY,IAAJ,CAAS3D,IAHgB;AAIhCE,YAAO6C,IAAIY,IAAJ,CAASzD,IAJgB;AAKhCC,YAAO4C,IAAIY,IAAJ,CAASxD,IALgB;AAMhCC,YAAO2C,IAAIY,IAAJ,CAASvD,IANgB;AAOhCC,cAAS0C,IAAIY,IAAJ,CAAStD,MAPc;AAQhCC,YAAOyC,IAAIY,IAAJ,CAASrD;AARgB,KAAN,EAA5B,EASI,EAACoE,KAAK,IAAN,EATJ,EASiB,CAACX,GAAD,EAAMC,KAAN,KAAgB;AAC/B,QAAID,GAAJ,EAAS;AACP5B,cAAQC,GAAR,CAAYuC,KAAZ;AACA,aAAO3B,IAAIiB,IAAJ,CAAS,IAAT,CAAP;AACD;AACDjB,QAAIkB,QAAJ,CAAa,QAAb;AACD,GAfD;AAgBD,CArBD;;AAuBAZ,aAAaR,GAAb,CAAiB,GAAjB,EAAqB,CAACC,GAAD,EAAMC,GAAN,KAAc;AACjCxC,EAAA,6DAAAA,CAAMoE,IAAN,CAAW,EAAX,EAAc,CAACb,GAAD,EAAMc,MAAN,KAAiB;AAC7B,QAAGd,GAAH,EAAQ,MAAMA,GAAN;AACRf,QAAIC,MAAJ,CAAW,SAAX,EAAsB,EAAC4B,MAAD,EAAtB;AACD,GAHD;AAKD,CAND;;AAUA;;AAEAvB,aAAaR,GAAb,CAAiB,QAAjB,EAA2B,CAACC,GAAD,EAAMC,GAAN,KAAc;AAACA,MAAIC,MAAJ,CAAW,UAAX;AACzC,CADD;;AAKAK,aAAaE,IAAb,CAAkB,QAAlB,EAA2B,CAACT,GAAD,EAAKC,GAAL,KAAa;AACtC,MAAI8B,UAAU,IAAI,2DAAJ,CAAS/B,IAAIY,IAAb,CAAd;AACAoB,EAAA,8CAAAA,CAAOC,OAAP,CAAe,EAAf,EAAmB,UAASjB,GAAT,EAAckB,IAAd,EAAmB;AAClCF,IAAA,8CAAAA,CAAOG,IAAP,CAAYJ,QAAQ7D,QAApB,EAA8BgE,IAA9B,EAAoC,UAASlB,GAAT,EAAcmB,IAAd,EAAmB;AACrDJ,cAAQ7D,QAAR,GAAmBiE,IAAnB;AACAJ,cAAQhB,IAAR,CAAa,CAACC,GAAD,EAAMoB,IAAN,KAAe;AAC1B,YAAGpB,GAAH,EAASA,GAAD;AACR;AACA;;AAEAf,YAAIkB,QAAJ,CAAa,cAAb;AACD,OAND;AAOD,KATD;AAUH,GAXD;AAYD,CAdD;;AAgBAZ,aAAaR,GAAb,CAAiB,QAAjB,EAA2B,CAACC,GAAD,EAAMC,GAAN,KAAc;AACzCA,MAAIC,MAAJ,CAAW,OAAX;AACC,CAFD;;AAIAK,aAAaE,IAAb,CAAkB,QAAlB,EAA4B,gDAAAZ,CAASwC,YAAT,CAAsB,cAAtB,EAAsC;AAChEC,mBAAiB,QAD+C;AAEhEC,mBAAgB,cAFgD;AAGhEC,gBAAc;AAHkD,CAAtC,CAA5B;;;;;;;;ACzGA,oD;;;;;;;;;;;ACAA;AACA;;AAGA,MAAMC,cAAc,+CAAApE,CAAQmC,MAAR,EAApB;;AAGAiC,YAAY1C,GAAZ,CAAgB,MAAhB,EAAwB,CAACC,GAAD,EAAMC,GAAN,KAAc;AACpC,MAAImB,UAAUpB,IAAIqB,MAAJ,CAAWC,EAAzB;AACA7D,EAAA,6DAAAA,CAAM8D,QAAN,CAAeH,OAAf,EAAwB,CAACJ,GAAD,EAAMC,KAAN,KAAgB;AACtC,QAAGD,GAAH,EAAQ,MAAMA,GAAN;AACRf,QAAIC,MAAJ,CAAW,OAAX,EAAoB,EAACe,KAAD,EAApB;AACD,GAHD;AAID,CAND;;;;;;;;;;;;;;;ACPA;AACA;AACA;;AAEA,MAAOyB,gBAAgB,+CAAArE,CAAQmC,MAAR,EAAvB;;AAEAkC,cAAc3C,GAAd,CAAkB,GAAlB,EAAsB,CAACC,GAAD,EAAKC,GAAL,KAAa;AACjCxC,EAAA,6DAAAA,CAAMoE,IAAN,CAAW,EAAX,EAAe,CAACb,GAAD,EAAMc,MAAN,KAAiB;AAChC,QAAId,GAAJ,EAAS,MAAMA,GAAN;AACTf,QAAIC,MAAJ,CAAW,OAAX,EAAoB,EAAC4B,MAAD,EAApB;AACC,GAHD;AAID,CALD;;AAOAY,cAAc3C,GAAd,CAAkB,YAAlB,EAAgC,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC5CxC,EAAA,6DAAAA,CAAMoE,IAAN,CAAW,EAAX,EAAe,CAACb,GAAD,EAAMc,MAAN,KAAiB;AAChC,QAAId,GAAJ,EAAS,MAAMA,GAAN;AACTf,QAAIC,MAAJ,CAAW,KAAX,EAAkB,EAAC4B,MAAD,EAAlB;AACD,GAHC;AAID,CALD;;;;;;;;;;;;;;;ACbA;AACA;AACA;;AAEA,gDAAAjC,CAAS8C,aAAT,CAAuB,UAASP,IAAT,EAAeQ,IAAf,EAAoB;AACzCA,OAAK,IAAL,EAAWR,KAAKd,EAAhB;AACD,CAFD;;AAIA,gDAAAzB,CAASgD,eAAT,CAAyB,UAASvB,EAAT,EAAasB,IAAb,EAAkB;AACzCzE,EAAA,+DAAAA,CAAKoD,QAAL,CAAcD,EAAd,EAAkB,UAASN,GAAT,EAAcoB,IAAd,EAAmB;AACnCQ,SAAK5B,GAAL,EAAUoB,IAAV;AACD,GAFD;AAGD,CAJD;;AAMA,gDAAAvC,CAASvB,GAAT,CAAa,cAAb,EAA6B,IAAI,sDAAJ,CAAkB;AAC7CwE,iBAAgB,MAD6B;AAE7CC,iBAAgB,UAF6B;AAG7CC,qBAAmB;AAH0B,CAAlB,EAI1B,UAAShD,GAAT,EAAclC,IAAd,EAAoBI,QAApB,EAA8B0E,IAA9B,EAAmC;AACpCzE,EAAA,+DAAAA,CAAK8E,OAAL,CAAa,EAAC,QAAOnF,IAAR,EAAb,EAA4B,UAASkD,GAAT,EAAcoB,IAAd,EAAmB;AAC7C,QAAGpB,GAAH,EAAO;AACL,aAAO4B,KAAK5B,GAAL,CAAP;AACD;AACD,QAAGoB,IAAH,EAAQ;AACN,aAAOQ,KAAK,IAAL,EAAW,KAAX,EAAkB,EAACM,SAAQ,wBAAT,EAAlB,CAAP;AACD;AACD,QAAInB,UAAU,IAAI,+DAAJ,EAAd;AACAA,YAAQjE,IAAR,GAAeA,IAAf;AACAiE,YAAQ7D,QAAR,GAAmBA,QAAnB;AACA6D,YAAQhB,IAAR,CAAa,UAASC,GAAT,EAAcmC,MAAd,EAAqB;AAChC,UAAGnC,GAAH,EAAO;AACL,eAAO4B,KAAK5B,GAAL,CAAP;AACD;AACD,aAAO4B,KAAK,IAAL,EAAWb,OAAX,CAAP;AACD,KALD;AAMD,GAhBD;AAiBD,CAtB4B,CAA7B;;AAwBA,gDAAAlC,CAASvB,GAAT,CAAa,cAAb,EAA6B,IAAI,sDAAJ,CAAkB;AAC7CwE,iBAAc,MAD+B;AAE7CC,iBAAc,UAF+B;AAG7CC,qBAAmB;AAH0B,CAAlB,EAI1B,UAAShD,GAAT,EAAclC,IAAd,EAAoBI,QAApB,EAA8B0E,IAA9B,EAAmC;AACpCzE,EAAA,+DAAAA,CAAK8E,OAAL,CAAa,EAAC,QAAOnF,IAAR,EAAb,EAA4B,UAASkD,GAAT,EAAcoB,IAAd,EAAmB;AAC7C,QAAGpB,GAAH,EAAO;AACL,aAAO4B,KAAK5B,GAAL,CAAP;AACD;AACD,QAAG,CAACoB,IAAJ,EAAS;AACP,aAAOQ,KAAK,IAAL,EAAW,KAAX,EAAkB,EAACM,SAAQ,eAAT,EAAlB,CAAP;AACD;AACC,WAAON,KAAK,IAAL,EAAWR,IAAX,CAAP;AACD,GARH;AASD,CAd4B,CAA7B,E","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fe44e11de5ee60a0a24f","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","import mongoose from 'mongoose';\r\nconst Schema = mongoose.Schema\r\n\r\nconst livreSchema = new Schema({\r\n  titre:String,\r\n  auteur:String,\r\n  prix:Number,\r\n  isbn:String,\r\n  date:Number,\r\n  couv:String,\r\n  resume:String,\r\n  info:String,\r\n  cat:String\r\n})\r\n\r\n\r\nconst Livre = mongoose.model('Livre', livreSchema)\r\nexport { Livre }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/livres.js","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 4\n// module chunks = 0","import mongoose from 'mongoose';\nconst Schema = mongoose.Schema\nvar passportLocalMongoose = require('passport-local-mongoose');\n\nconst userSchema = new Schema ({\n  name:{type: String, index:{ unique:true}},\n  password:String\n})\n\nconst User = mongoose.model('User', userSchema)\nexport { User }\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/users.js","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"connect-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash\"\n// module id = 9\n// module chunks = 0","import express from 'express';\r\nconst app = express();\r\nimport mongoose from 'mongoose';\r\nimport bodyParser from 'body-parser';\r\nimport volleyball from 'volleyball';\r\nimport 'dotenv/config';\r\nimport path from 'path';\r\nimport multer from 'multer';\r\nimport bcrypt from 'bcrypt';\r\nimport LocalStrategy from 'passport-local';\r\nimport flash from 'connect-flash';\r\nimport session from 'express-session';\r\nimport passport from \"passport\";\r\n\r\n\r\napp.use(express.static('public'))\r\napp.set('views', path.join(__dirname + '/views'))\r\napp.set('view engine','pug')\r\n//app.use(express.static(path.join(__dirname, 'public')))\r\n\r\nimport { livresRouter } from './routes/addbook.js'\r\nimport { ficheRouter } from './routes/fiche.js'\r\nimport { accueilRouter } from './routes/accueil.js'\r\n\r\n\r\nconst { SERVER_PORT, DBUrl } = process.env\r\nconst url = DBUrl;\r\n\r\napp.use(bodyParser.urlencoded({ extended : true }))\r\nimport { Livre } from \"./models/livres\";\r\nconsole.log(Livre)\r\n\r\n\r\nmongoose.connection.on('connected',() => {\r\n  console.log(`[MongoDb] is running on port 27017`);\r\n})\r\nmongoose.connect(url);\r\n\r\n\r\nrequire('../config/passport');\r\napp.use(express.json())\r\napp.use(express.urlencoded({extended : true}))\r\napp.use(volleyball);\r\napp.use(session({secret:\"secret\"}))\r\napp.use(flash());\r\napp.use(passport.initialize());\r\napp.use(passport.session());\r\n\r\n\r\n\r\napp.use('/admin', livresRouter)\r\napp.use('/livres', ficheRouter)\r\napp.use('/accueil', accueilRouter)\r\n\r\napp.get('/', (req, res) => {\r\n  res.render('test')\r\n})\r\n\r\n//\r\nimport { User } from './models/users';\r\n//passport.use(new LocalStrategy(User.authenticate()));\r\n//passport.serializeUser(User.serializeUser());\r\n//passport.deserializeUser(User.deserializeUser());\r\n//\r\n\r\n\r\n\r\n\r\n/*app.set(\"listcat\", function(livre){\r\n  let cat = [];\r\n  let cat2 = [];\r\n  cat.push(livre.cat);\r\n  cat.sort();\r\n  for(var i = 0; i<cat.length; i++){\r\n    if(cat[i]!==cat[i+1]){\r\n      cat2.push(cat[i])\r\n    }\r\n  }\r\n  return cat2\r\n})*/\r\n\r\n\r\napp.listen(SERVER_PORT,() => {\r\n  console.log(`Express running on:`, SERVER_PORT)\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"volleyball\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"volleyball\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"dotenv/config\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv/config\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 15\n// module chunks = 0","import express from \"express\";\r\nimport { Livre } from \"../models/livres\";\r\nimport { User } from \"../models/users\";\r\nimport bodyParser from \"body-parser\"\r\nimport multer from \"multer\";\r\nimport bcrypt from 'bcrypt';\r\nimport flash from 'connect-flash';\r\nimport passport from 'passport';\r\n\r\nconst upload = multer({dest:'public/uploads/'});\r\n\r\nconst livresRouter = express.Router();\r\n\r\n\r\n\r\nlivresRouter.get('/addbook',(req,res) => {\r\n  res.render(\"admin\")\r\n})\r\n\r\nlivresRouter.post('/addbook', upload.single('couv'),(req,res) => {\r\n  let newlivre = new Livre(req.body)\r\n  if(req.file){\r\n     newlivre.couv = req.file.filename\r\n  }else{\r\n    newlivre.couv = \"noimage.png\"\r\n  }\r\n\r\n  newlivre.save((err,livre) => {\r\n    if(err) res.send(err)\r\n    res.redirect('/admin')\r\n\r\n  });\r\n\r\n});\r\n//load edit\r\nlivresRouter.get('/edit/:id', (req, res) => {\r\n  let livreid = req.params.id;\r\n  Livre.findById(livreid, (err, livre) => {\r\n    if(err) throw err\r\n\r\n    res.render(\"editlivre\", {livre: livre});\r\n  });\r\n});\r\n\r\n//update submit\r\nlivresRouter.post('/edit/:id', (req, res) => {\r\n  if(!req.body){\r\n    return res.sendStatus(500);\r\n  }\r\n  const id = req.params.id;\r\n  Livre.findByIdAndUpdate(id, {$set:{\r\n    titre :req.body.titre,\r\n    auteur : req.body.auteur,\r\n    prix : req.body.prix,\r\n    isbn : req.body.isbn,\r\n    date : req.body.date,\r\n    couv : req.body.couv,\r\n    resume : req.body.resume,\r\n    info : req.body.info\r\n  }}, {new: true}, (err, livre) => {\r\n    if (err) {\r\n      console.log(error)\r\n      return res.send(\"ok\")\r\n    }\r\n    res.redirect('/admin')\r\n  })\r\n});\r\n\r\nlivresRouter.get('/',(req, res) => {\r\n  Livre.find({},(err, livres) => {\r\n    if(err) throw err\r\n    res.render(\"gestion\", {livres})\r\n  });\r\n\r\n});\r\n\r\n\r\n\r\n// page d'engeristrement de users\r\n\r\nlivresRouter.get('/users', (req, res) => {res.render(\"register\")\r\n})\r\n\r\n\r\n\r\nlivresRouter.post('/users',(req,res) => {\r\n  let newUser = new User(req.body)\r\n  bcrypt.genSalt(10, function(err, salt){\r\n      bcrypt.hash(newUser.password, salt, function(err, hash){\r\n        newUser.password = hash\r\n        newUser.save((err, user) => {\r\n          if(err) (err)\r\n          //req.flash('success', 'you are now registered');\r\n          //res.location('/users')\r\n\r\n          res.redirect('/admin/login');\r\n        })\r\n      })\r\n  });\r\n});\r\n\r\nlivresRouter.get('/login', (req, res) => {\r\nres.render(\"login\")\r\n})\r\n\r\nlivresRouter.post('/login', passport.authenticate('local-signin', {\r\n  successRedirect: '/admin',\r\n  failureRedirect:'/admin/users',\r\n  failureFlash: true\r\n}))\r\n\r\n\r\n\r\nexport { livresRouter }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/addbook.js","module.exports = require(\"passport-local-mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local-mongoose\"\n// module id = 17\n// module chunks = 0","import express from \"express\"\r\nimport { Livre } from \"../models/livres\"\r\n\r\n\r\nconst ficheRouter = express.Router();\r\n\r\n\r\nficheRouter.get('/:id', (req, res) => {\r\n  let livreid = req.params.id;\r\n  Livre.findById(livreid, (err, livre) => {\r\n    if(err) throw err\r\n    res.render(\"fiche\", {livre});\r\n  });\r\n});\r\n\r\n\r\n\r\nexport { ficheRouter }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/fiche.js","import express from \"express\";\nimport { Livre } from \"../models/livres\";\nimport bodyParser from \"body-parser\"\n\nconst  accueilRouter = express.Router();\n\naccueilRouter.get('/',(req,res) => {\n  Livre.find({}, (err, livres) => {\n  if (err) throw err\n  res.render(\"index\", {livres})\n  });\n});\n\naccueilRouter.get('/categorie', (req, res) => {\n  Livre.find({}, (err, livres) => {\n  if (err) throw err\n  res.render(\"cat\", {livres})\n});\n});\n\nexport { accueilRouter }\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/accueil.js","import passport from 'passport'\nimport { User } from \"../src/models/users\"\nimport LocalStrategy from 'passport-local';\n\npassport.serializeUser(function(user, done){\n  done(null, user.id);\n});\n\npassport.deserializeUser(function(id, done){\n  User.findById(id, function(err, user){\n    done(err, user);\n  })\n});\n\npassport.use('local-signup', new LocalStrategy({\n  usernameField : \"name\",\n  passwordField : \"password\",\n  passReqToCallback: true\n}, function(req, name, password, done){\n  User.findOne({'name':name}, function(err, user){\n    if(err){\n      return done(err);\n    }\n    if(user){\n      return done(null, false, {message:'name is already in use'});\n    }\n    var newUser = new User();\n    newUser.name = name;\n    newUser.password = password;\n    newUser.save(function(err, result){\n      if(err){\n        return done(err)\n      }\n      return done(null, newUser);\n    });\n  });\n}));\n\npassport.use('local-signin', new LocalStrategy({\n  usernameField:'name',\n  passwordField:'password',\n  passReqToCallback: true\n}, function(req, name, password, done){\n  User.findOne({'name':name}, function(err, user){\n    if(err){\n      return done(err);\n    }\n    if(!user){\n      return done(null, false, {message:'no user found'});\n    }\n      return done(null, user);\n    });  \n}));\n\n\n\n// WEBPACK FOOTER //\n// ./config/passport.js"],"sourceRoot":""}